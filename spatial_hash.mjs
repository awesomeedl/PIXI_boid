import"victor";import{app as s}from"./main.mjs";import{Boid as h,Flock as t}from"./boid.mjs";import{visibleRange as i}from"./boid.mjs";class e{constructor(){this.numRows=Math.ceil(s.renderer.height/i),this.numCols=Math.ceil(s.renderer.width/i),this.hashTable=Array.from(Array(this.numRows*this.numCols),(()=>[]))}refresh(h){this.numRows=Math.ceil(s.renderer.height/i),this.numCols=Math.ceil(s.renderer.width/i),this.hashTable=Array.from(Array(this.numRows*this.numCols),(()=>[]));for(let s of h.flock){let h=this.getIndex(s.position);s.spatialIndex=h,this.hashTable[h].push(s)}}getIndex(s){return Math.floor(s.x/i)+Math.floor(s.y/i)*this.numCols}getNeighbors(s){let h=[],t=s>=this.numCols,i=s+this.numCols<this.hashTable.length,e=s%this.numCols!=0,o=(s+1)%this.numCols!=0;return h.push(...this.hashTable[s]),t&&h.push(...this.hashTable[s-this.numCols]),i&&h.push(...this.hashTable[s+this.numCols]),e&&h.push(...this.hashTable[s-1]),o&&h.push(...this.hashTable[s+1]),t&&e&&h.push(...this.hashTable[s-this.numCols-1]),t&&o&&h.push(...this.hashTable[s-this.numCols+1]),i&&e&&h.push(...this.hashTable[s+this.numCols-1]),i&&o&&h.push(...this.hashTable[s+this.numCols+1]),h}}export{e as SpatialHash};